# 0115 공부

## TCP 송/수신

### TCP/IP 연결

- 소켓 연결로 파일을 보낸다고 해보자

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/cd5a9889-b511-42c7-bf9f-10ded251c027/Untitled.png)

소켓 통신을 하나 한다고 치자.

- 일단 소켓의 본질은 `파일`이다. 그러면 서버는 `프로세스` 이다.
- 기본적으로 프로세스가 파일에게 할 수 있는 것은 읽기,쓰기,사용 이다.
- 그러면 이때 읽기란, 2차 기억장치에 있는 File 을 읽어 올때
- 2차 기억장치 → 드라이버 → 파일 시스템순으로 읽는다.
- 프로세스는 해당 파일의 받기 위한 공간을 마련했을 것이다.
    - 이 공간은 우리는 Buffer 라고 한다.
- Buffer 단위로 읽어 온뒤에 소켓의 TCP 연결이 이어져 있는 곳에서 분해가 일어나는데
- 이때 Buffer 위에 파일을 잘라서 보는데 이 자른 단위를 Segmant 라고 한다.
- Segmant 를 담고 있는게 패킷이다.
- 패킷을 택배라고 치면 택배차는 Frame 인데.
- 계속 네트워크를 내려오다보면 NIC ( L2 ) 가 Frame 이라고 생각하면된다.
- 논리적으로 end to end 로 가는거지만, 물리적으로는 나누어져서 간다.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/0a1458ac-1b87-47c5-9b7a-d861ed017095/Untitled.png)

- 받으면 TCP, IP 에서 받음
- 1,2를 받으면 Ack3 으로 보냄
- 이는 앞에것을 잘받아고 3 을 보내라는 거임
- ack 가 올때 까지 server 는 wait 한다. ( 그래서 UDP 가 더 빠르다는것이다. )
- ack 가 와도 받는 쪽에 window size 가 작으면 안보낸다. ( 중요 )
- 결국 느리면 서버탓도 있지만 클라이언트 탓도 있다.
- 최대한 TCP Buffer 에서 File 로 옮겨야 하지 않을까 ?
- 그래서 파일 Read 쪽 속도가 느리면 TCP buffer 가 빨리 안비워짐으로 server 쪽에서 wait 함

- 그래서 소켓 프로그래밍 할때 File I/O Buffer 빠른지 TCP Buffer 가 잘 비워지는지를 확인해야한다.

출처 : [https://www.youtube.com/watch?v=K9L9YZhEjC0&ab_channel=널널한개발자TV](https://www.youtube.com/watch?v=K9L9YZhEjC0&ab_channel=%EB%84%90%EB%84%90%ED%95%9C%EA%B0%9C%EB%B0%9C%EC%9E%90TV)

### 도커에 대해서

- 보통의 전산 자원은 HW 에 집중되어 있다.
- 가상메모리는 프로세스 마다 독립적인 공간

VM 일때

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/740ce1ec-bc4c-4c45-959c-9273dac5b4f9/Untitled.png)

- Driver 늘린다고 가정해보자
- VM 으로 할때는 Linux 를 깔면
- H/W , K U 가 새로 쌓이는 형태이다.
- 이때 생기는 NIC 는 가상의 Network inteface Card 이다.
- Virtual NIC 가 생겨서 이것으로 나간다
- 원본은 Host , 나머지는 Guest 라 하고
- 마치 L2 Switch 처럼 Virtual NIC 를 씁니다.
- 그런데 꼭 H/W 나 K 이 필요할까 ?

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/bfc2d101-30e5-4ab4-ba2c-c80c79258f74/Untitled.png)

- application 이랑 bin 조금 갔다 쉽게 쉽게 할 수 있게 하자
- 나머지는 도커 엔진이 처리 (OS 나 가상화된 HW 등 )

[https://www.youtube.com/watch?v=zh0OMXg2Kog&t=1&ab_channel=널널한개발자TV](https://www.youtube.com/watch?v=zh0OMXg2Kog&t=1&ab_channel=%EB%84%90%EB%84%90%ED%95%9C%EA%B0%9C%EB%B0%9C%EC%9E%90TV)
